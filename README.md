# TWorld 자동화 도구 (TW_AUTO)

TWorld 웹사이트에 자동으로 로그인하여 요금제, 데이터 사용량, 부가서비스 등의 정보를 수집하는 프로그램입니다.

## 1. 기능
- **자동 로그인**: 엑셀 파일에 저장된 계정 정보로 자동 로그인
- **정보 수집**:
  - 요금제 정보
  - 데이터 사용량 (총 제공량, 잔여량)
  - 문자 메시지 잔여량
  - 선물하기 가능 횟수 (데이터/충전)
  - 소액결제 이용 내역 (휴대폰, 콘텐츠, 데이터, 정보이용료)
  - 청구 요금 정보
  - 부가서비스 가입 정보
- **결과 저장**: 수집된 정보를 엑셀 파일(`result_YYYYMMDD_HHMMSS.xlsx`)로 저장
- **텔레그램 알림**: 작업 완료 및 오류 발생 시 텔레그램으로 알림 전송
- **에러 캡처**: 오류 발생 시 화면을 캡처하여 `error` 폴더에 저장

## 2. 사용 방법 (배포판 기준)

### 2.1. 준비물
프로그램을 실행하기 위해 다음 파일들이 하나의 폴더에 있어야 합니다.
1. `tw_auto.exe`: 실행 파일
2. `browsers` 폴더: 브라우저 엔진 (없으면 인터넷에서 자동 다운로드 시도함)
3. `accounts.xlsx`: 계정 정보 파일

### 2.2. 계정 정보 입력 (`accounts.xlsx`)
`accounts.xlsx` 파일을 열어 다음과 같이 계정 정보를 입력하세요.
- **A열 (ID)**: TWorld 아이디
- **B열 (PW)**: TWorld 비밀번호
- **C열 (Order)**: 순번 (선택 사항)

### 2.3. 실행
1. `tw_auto.exe` 파일을 실행합니다.
2. **"찾아보기"** 버튼을 눌러 `accounts.xlsx` 파일을 선택합니다.
3. **"동시 실행 브라우저 수"**를 설정합니다. (기본값: 5)
   - PC 사양에 따라 조절하세요. 너무 높으면 렉이 걸릴 수 있습니다.
4. **"작업 시작"** 버튼을 누릅니다.

### 2.4. 결과 확인
- 작업이 완료되면 프로그램이 있는 폴더에 `result_날짜_시간.xlsx` 파일이 생성됩니다.
- 오류가 발생한 경우 `error` 폴더에 스크린샷이 저장됩니다.
- 실행 로그는 프로그램 화면과 `debug.log` 파일에서 확인할 수 있습니다.

## 3. 개발 및 빌드 방법

### 3.1. 환경 설정
Python 3.8 이상이 필요합니다.
```bash
pip install -r requirements.txt
playwright install chromium
```

### 3.2. 실행 (개발 모드)
```bash
python main.py
```

### 3.3. exe 파일 빌드 (배포용)
`PyInstaller`를 사용하여 exe 파일을 생성합니다.
```bash
pyinstaller tw_auto.spec
```
빌드가 완료되면 `dist` 폴더에 `tw_auto.exe` 파일이 생성됩니다.

## 4. 문제 해결

### 4.1. 브라우저 관련 오류
- **증상**: "브라우저를 찾을 수 없습니다" 또는 실행하자마자 종료됨
- **해결**: `browsers` 폴더가 `tw_auto.exe`와 같은 위치에 있는지 확인하세요. 없다면 인터넷이 연결된 상태에서 실행하여 다운로드를 기다리세요.

### 4.2. 캡챠(보안문자) 발생
- **증상**: 로그인 시 "로봇이 아닙니다" 체크박스나 이미지 맞추기가 뜸
- **해결**: 자동화 탐지를 피하기 위해 브라우저 설정을 최적화했으나, 완벽하지 않을 수 있습니다. 너무 자주 발생하면 잠시 후 다시 시도하거나 IP를 변경해보세요.

### 4.3. 실행 안 됨 (다른 PC)
- **증상**: 다른 컴퓨터에서 실행하면 아무 반응이 없거나 에러 발생
- **해결**: `debug.log` 파일을 열어 오류 내용을 확인하세요. 대부분 `browsers` 폴더가 없거나 경로 문제일 수 있습니다.
